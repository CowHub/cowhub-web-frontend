test:
  override:
    - npm run build
  post:
    - git fetch --unshallow ; echo
    - git remote add gitlab git@gitlab.doc.ic.ac.uk:cowhub/cowhub-web-frontend
    - git push gitlab $(git branch | grep \* | awk -F ' ' '{ print $2 }')

deployment:
  production:
    branch: master
    commands:
      - cp public/index.html dist/
      - aws s3 sync dist s3://cowhub-web-frontend/ --delete --grants read=uri=http://acs.amazonaws.com/groups/global/AllUsers --storage-class REDUCED_REDUNDANCY
